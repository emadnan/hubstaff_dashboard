"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[9347],{79347:function(e,t,n){n.r(t);var r=n(74165),s=n(15861),o=n(29439),c=n(72791),i=n(99954),a=n(87309),l=n(81640),d=n(15696),u=n(76821),h=n(18808),x=n.n(h),m=n(92552),f=n(53201),p=n(27767),g=n(8266),j=n(37029),y=n(83168),b=n(97892),_=n.n(b),v=(n(83883),n(80184)),Z="http://10.3.3.80",U=i.Z.RangePicker;_().extend(x());t.default=function(){var e=JSON.parse(localStorage.getItem("user-info"));function t(t,n){var r,s,o;t?(console.log("From: ",t[0],", to: ",t[1]),console.log("From: ",n[0],", to: ",n[1]),5===e.Users.role||6===e.Users.role||7===e.Users.role?(r=n[0],s=n[1],o=e.Users.user_id,fetch("".concat(Z,"/api/get_projectscreenshot_by_date/").concat(r,"/").concat(s,"/").concat(o)).then((function(e){return e.json()})).then((function(t){pe=1===e.Users.role||3===e.Users.role?t.projectscreenshot:t.projectscreenshot.filter((function(t){return t.user_id===e.Users.user_id})),b(pe)})).catch((function(e){return console.log(e)})),Ze(n[0],n[1],e.Users.user_id)):3===e.Users.role&&(!function(e,t,n){fetch("".concat(Z,"/api/get_projectscreenshot_by_compny_id/").concat(e,"/").concat(t,"/").concat(n)).then((function(e){return e.json()})).then((function(e){b(pe=e)})).catch((function(e){return console.log(e)}))}(n[0],n[1],e.Users.company_id),Ze(n[0],n[1],B))):console.log("Clear")}var n=function(){t("")},i=(0,c.useState)([]),h=(0,o.Z)(i,2),x=h[0],b=h[1],_=(0,c.useState)([]),S=(0,o.Z)(_,2),k=S[0],w=S[1],C=(0,c.useState)([]),I=(0,o.Z)(C,2),T=(I[0],I[1]),W=(0,c.useState)([]),P=(0,o.Z)(W,2),D=P[0],F=P[1],O=(0,c.useState)(""),z=(0,o.Z)(O,2),B=z[0],L=z[1],N=(0,c.useState)(""),R=(0,o.Z)(N,2),Y=(R[0],R[1],e.Users,(0,c.useState)("")),K=(0,o.Z)(Y,2),M=(K[0],K[1],(0,c.useState)([])),A=(0,o.Z)(M,2),G=(A[0],A[1],(0,c.useState)("")),X=(0,o.Z)(G,2),q=X[0],E=X[1],J=(0,c.useState)(""),H=(0,o.Z)(J,2),Q=H[0],V=H[1],$=(0,c.useState)(""),ee=(0,o.Z)($,2),te=ee[0],ne=ee[1],re=(0,c.useState)(""),se=(0,o.Z)(re,2),oe=se[0],ce=se[1],ie=(0,c.useState)(""),ae=(0,o.Z)(ie,2),le=ae[0],de=ae[1],ue=(0,c.useState)(""),he=(0,o.Z)(ue,2),xe=he[0],me=he[1],fe=[],pe=[],ge=(0,c.useState)([]),je=(0,o.Z)(ge,2),ye=je[0],be=je[1];function _e(){n(),fetch("".concat(Z,"/api/get_Project_Screenshots")).then((function(e){return e.json()})).then((function(t){1===e.Users.role?pe=t.projectscreenshot:3===e.Users.role?pe=t.projectscreenshot.filter((function(t){return t.company_id===e.Users.company_id})):5!==e.Users.role&&6!==e.Users.role&&7!==e.Users.role||(pe=t.projectscreenshot.filter((function(t){return t.user_id===e.Users.user_id}))),b(pe)})).catch((function(e){return console.log(e)}))}function ve(e){fetch("".concat(Z,"/api/getTotalWorkbyUserId/").concat(e)).then((function(e){return e.json()})).then((function(e){E(e.hours),V(e.minutes),ne(e.seconds)})).catch((function(e){return console.log(e)}))}function Ze(e,t,n){fetch("".concat(Z,"/api/getSumByDateWithUserId/").concat(e,"/").concat(t,"/").concat(n)).then((function(e){return e.json()})).then((function(e){ce(e.hours),de(e.minutes),me(e.seconds)})).catch((function(e){return console.log(e)}))}(0,c.useEffect)((function(){fetch("".concat(Z,"/api/get_users")).then((function(e){return e.json()})).then((function(t){1===e.Users.role?fe=t.Users:3===e.Users.role?fe=t.Users.filter((function(t){return t.company_id===e.Users.company_id})):5!==e.Users.role&&6!==e.Users.role&&7!==e.Users.role||(fe=t.Users.filter((function(e){return e.id===B}))),w(fe.slice(1))})).catch((function(e){return console.log(e)})),fetch("".concat(Z,"/api/getproject")).then((function(e){return e.json()})).then((function(e){return T(e.projects)})).catch((function(e){return console.log(e)})),_e()}),[]);var Ue=(0,c.useState)(!1),Se=(0,o.Z)(Ue,2),ke=Se[0],we=Se[1],Ce=(0,c.useCallback)((function(e){var t=e.map((function(e){return e.path_url}));be(t),we(!0)}),[]),Ie=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(t,n){var s,o,c,i,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"AIzaSyBSBflGv5OULqd9TPMLKecXIig07YXKW2A",s="https://maps.googleapis.com/maps/api/geocode/json?latlng=".concat(t,",").concat(n,"&key=").concat("AIzaSyBSBflGv5OULqd9TPMLKecXIig07YXKW2A"),e.prev=2,e.next=5,fetch(s);case 5:return o=e.sent,e.next=8,o.json();case 8:"OK"===(c=e.sent).status?(i=c.results.find((function(e){return"ROOFTOP"===e.geometry.location_type})),a=i?i.formatted_address:c.results[0].formatted_address,console.log(a),console.log(c),F(a)):console.error(c.status),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,n){return e.apply(this,arguments)}}();return(0,v.jsxs)(v.Fragment,{children:[3===e.Users.role?(0,v.jsxs)("div",{children:[(0,v.jsxs)("h3",{children:["Location ",D.length>0&&(0,v.jsx)("h3",{style:{color:"black",fontSize:18},children:D})]}),(0,v.jsx)("br",{}),(0,v.jsxs)("h3",{children:["Today Worked ",q,":",Q,":",te]}),(0,v.jsxs)("h3",{children:["Total Worked ",oe,":",le,":",xe]})]}):null,5===e.Users.role||6===e.Users.role||7===e.Users.role?(0,v.jsx)("div",{children:oe||le||xe?(0,v.jsxs)("h3",{children:["Total Worked ",oe,":",le,":",xe]}):(0,v.jsx)("h3",{children:"Total Worked 0:0:0"})}):null,(0,v.jsxs)("div",{className:"row",children:[(0,v.jsxs)("div",{className:"col-md-4",children:[(0,v.jsx)("br",{}),(0,v.jsx)(U,{format:"YYYY-MM-DD",onChange:t}),(0,v.jsx)(a.ZP,{type:"default",onClick:_e,children:"Today"})]}),(0,v.jsx)("div",{className:"col-md-4"}),1===e.Users.role||3===e.Users.role?(0,v.jsx)("div",{className:"col-md-4 mt-4",children:(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-md-4"}),(0,v.jsx)("div",{className:"col-md-8",children:(0,v.jsx)(l.Z.Item,{name:"select",hasFeedback:!0,children:(0,v.jsx)(d.Z,{placeholder:"Members",onChange:function(t){L(t),ve(t);var n=x.filter((function(n){return e.Users.role,n.user_id===t}));Ie(n[0].latitude,n[0].longitude)},value:B,children:k.map((function(e){return(0,v.jsx)(d.Z.Option,{value:e.id,children:e.name},e.id)}))})})})]})}):null]}),(0,v.jsx)(j.Z,{}),(0,v.jsxs)("div",{style:{display:"flex",flexWrap:"wrap"},children:[B?x.filter((function(e){return e.user_id===B})).map((function(e){return(0,v.jsx)(v.Fragment,{children:e.get_timings.map((function(t){return(0,v.jsx)("div",{style:{cursor:"pointer"},children:(0,v.jsxs)(p.Z,{variant:"outlined",sx:{width:240,my:1,mx:1},onClick:function(){return Ce(t.getattechments)},children:[(0,v.jsx)(g.Z,{children:(0,v.jsx)(m.Z,{ratio:"2",children:t.getattechments.map((function(e){return(0,v.jsxs)("div",{style:{position:"relative"},children:[(0,v.jsx)("img",{src:e.path_url,alt:e.path_url,style:{filter:"blur(3px)"}}),(0,v.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backdropFilter:"blur(10px)",padding:"8px 18px",borderRadius:"4px",backgroundColor:"rgba(255, 255, 255, 0.8)",border:"2px solid black"},children:(0,v.jsx)("span",{style:{fontSize:"24px",fontWeight:"bold"},children:t.getattechments.length})})]},e.id)}))})}),(0,v.jsx)(y.ZP,{level:"h2",sx:{fontSize:"md",mt:1},children:e.project_name}),(0,v.jsx)(y.ZP,{level:"body2",sx:{mt:.5,mb:1},children:e.stream_name}),(0,v.jsx)(f.Z,{sx:{display:"flex",alignItems:"center",gap:.5,mx:"auto",my:.5},children:t.getattechments.map((function(e,t){return(0,v.jsx)(f.Z,{sx:{borderRadius:"50%",width:"max(".concat(6-t,"px, 3px)"),height:"max(".concat(6-t,"px, 3px)"),bgcolor:0===t?"primary.solidBg":"background.level3"}},t)}))}),(0,v.jsx)(j.Z,{}),(0,v.jsxs)(g.Z,{variant:"soft",sx:{display:"flex",flexDirection:"row",gap:1,py:1,px:"var(--Card-padding)",bgcolor:"background.level1"},children:[(0,v.jsxs)(y.ZP,{level:"body3",sx:{fontWeight:"md",color:"text.secondary"},children:[new Date(t.start_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}).substring(0,11)," ","-",new Date(t.end_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}).substring(0,11)]}),(0,v.jsx)(y.ZP,{level:"body3",sx:{fontWeight:"md",color:"text.secondary"},children:new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"long",day:"2-digit"}).format(new Date(t.created_at))})]})]})},t.id)}))})})):x.map((function(e){return(0,v.jsx)(v.Fragment,{children:e.get_timings.map((function(t){return(0,v.jsx)("div",{style:{cursor:"pointer"},children:(0,v.jsxs)(p.Z,{variant:"outlined",sx:{width:240,my:1,mx:1},onClick:function(){return Ce(t.getattechments)},children:[(0,v.jsx)(g.Z,{children:(0,v.jsx)(m.Z,{ratio:"2",children:t.getattechments.map((function(e){return(0,v.jsxs)("div",{style:{position:"relative"},children:[(0,v.jsx)("img",{src:e.path_url,alt:e.path_url,style:{filter:"blur(3px)"}}),(0,v.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backdropFilter:"blur(10px)",padding:"8px 18px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.8)",border:"2px solid black"},children:(0,v.jsx)("span",{style:{fontSize:"22px",fontWeight:"bold"},children:t.getattechments.length})})]},e.id)}))})}),(0,v.jsx)(y.ZP,{level:"h2",sx:{fontSize:"md",mt:1},children:e.project_name}),(0,v.jsx)(y.ZP,{level:"body2",sx:{mt:.5,mb:1},children:e.stream_name}),(0,v.jsx)(f.Z,{sx:{display:"flex",alignItems:"center",gap:.5,mx:"auto",my:.5},children:t.getattechments.map((function(e,t){return(0,v.jsx)(f.Z,{sx:{borderRadius:"50%",width:"max(".concat(6-t,"px, 3px)"),height:"max(".concat(6-t,"px, 3px)"),bgcolor:0===t?"primary.solidBg":"background.level3"}},t)}))}),(0,v.jsx)(j.Z,{}),(0,v.jsxs)(g.Z,{variant:"soft",sx:{display:"flex",flexDirection:"row",gap:1,py:1,px:"var(--Card-padding)",bgcolor:"background.level1"},children:[(0,v.jsxs)(y.ZP,{level:"body3",sx:{fontWeight:"md",color:"text.secondary"},children:[new Date(t.start_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}).substring(0,11)," ","-",new Date(t.end_time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}).substring(0,11)]}),(0,v.jsx)(y.ZP,{level:"body3",sx:{fontWeight:"md",color:"text.secondary"},children:new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"long",day:"2-digit"}).format(new Date(t.created_at))})]})]})},t.id)}))})})),(0,v.jsx)("div",{style:{position:"fixed",zIndex:9999},children:ke&&ye&&(0,v.jsx)(u.Z,{src:ye,currentIndex:0,disableScroll:!1,closeOnClickOutside:!0,onClose:function(){be(null),we(!1)},zIndex:9999})})]})]})}}}]);
//# sourceMappingURL=9347.b9d0eb74.chunk.js.map
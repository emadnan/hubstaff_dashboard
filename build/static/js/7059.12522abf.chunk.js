"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[7059],{77059:function(e,n,t){t.r(n);var o=t(74165),r=t(15861),c=t(29439),a=t(78983),s=t(87309),l=t(42535),i=t(81640),u=t(15696),d=t(72791),m=t(13400),f=t(27247),h=t(41286),p=t(19658),y=t(80184),x="http://10.3.3.80";n.default=function(){var e=(0,d.useState)(""),n=(0,c.Z)(e,2),t=n[0],j=n[1],C=(0,d.useState)(""),v=(0,c.Z)(C,2),Z=v[0],g=v[1],N=(0,d.useState)(""),b=(0,c.Z)(N,2),S=b[0],_=b[1],k=(0,d.useState)(""),T=(0,c.Z)(k,2),E=T[0],w=T[1],O=(0,d.useState)(""),A=(0,c.Z)(O,2),U=A[0],V=A[1],F=(0,d.useState)(""),P=(0,c.Z)(F,2),I=P[0],z=P[1],B=JSON.parse(localStorage.getItem("user-info")),D=B.permissions.map((function(e){return{name:e.name}})),J=D.some((function(e){return"Update_Company"===e.name})),M=D.some((function(e){return"Delete_Company"===e.name})),H=D.some((function(e){return"Create_Company"===e.name})),L={position:"fixed",top:"10%",left:"55%",transform:"translateX(-50%)"},R={color:"white",backgroundColor:"#0070FF ",padding:"15px",fontFamily:"Arial",textAlign:"center",alignSelf:"flex-end"},W={backgroundColor:"white "},X=(0,d.useState)(!1),q=(0,c.Z)(X,2),G=q[0],K=q[1],Q=(0,d.useState)(!1),Y=(0,c.Z)(Q,2),$=Y[0],ee=Y[1],ne=(0,d.useState)(!1),te=(0,c.Z)(ne,2),oe=te[0],re=te[1],ce=function(e){!function(e){fetch("".concat(x,"/api/get_company_by_id/").concat(e)).then((function(e){return e.json()})).then((function(e){Xe(e.company),j(e.company[0].company_name),_(e.company[0].company_email),g(e.company[0].address),w(e.company[0].contact_no),z(e.company[0].country),V(e.company[0].city)})).catch((function(e){return console.log(e)}))}(e),re(e)},ae=(0,d.useState)(!1),se=(0,c.Z)(ae,2),le=se[0],ie=se[1];(0,d.useEffect)((function(){if(le){var e=setTimeout((function(){ie(!1)}),3e3);return function(){return clearTimeout(e)}}}),[le]);var ue=(0,d.useState)(!1),de=(0,c.Z)(ue,2),me=de[0],fe=de[1];(0,d.useEffect)((function(){if(me){var e=setTimeout((function(){fe(!1)}),3e3);return function(){return clearTimeout(e)}}}),[me]);var he=(0,d.useState)(!1),pe=(0,c.Z)(he,2),ye=pe[0],xe=pe[1];(0,d.useEffect)((function(){if(ye){var e=setTimeout((function(){xe(!1)}),3e3);return function(){return clearTimeout(e)}}}),[ye]);var je=(0,d.useState)(!1),Ce=(0,c.Z)(je,2),ve=Ce[0],Ze=Ce[1];(0,d.useEffect)((function(){if(ve){var e=setTimeout((function(){Ze(!1)}),3e3);return function(){return clearTimeout(e)}}}),[ve]);var ge=(0,d.useState)(!1),Ne=(0,c.Z)(ge,2),be=Ne[0],Se=Ne[1];(0,d.useEffect)((function(){if(be){var e=setTimeout((function(){Se(!1)}),3e3);return function(){return clearTimeout(e)}}}),[be]);var _e=(0,d.useState)(!1),ke=(0,c.Z)(_e,2),Te=ke[0],Ee=ke[1];(0,d.useEffect)((function(){if(Te){var e=setTimeout((function(){Ee(!1)}),3e3);return function(){return clearTimeout(e)}}}),[Te]);var we=function(e){z(e);var n,t=ze.find((function(n){return n.name===e}));n=t.id,fetch("".concat(x,"/api/get_cities/").concat(n)).then((function(e){return e.json()})).then((function(e){return He(e.Cities)})).catch((function(e){return console.log(e)})),V("")},Oe=function(e){V(e)},Ae=(0,d.useState)([]),Ue=(0,c.Z)(Ae,2),Ve=Ue[0],Fe=Ue[1],Pe=(0,d.useState)([]),Ie=(0,c.Z)(Pe,2),ze=Ie[0],Be=Ie[1],De=(0,d.useState)([]),Je=(0,c.Z)(De,2),Me=Je[0],He=Je[1],Le=(0,d.useState)([]),Re=(0,c.Z)(Le,2),We=Re[0],Xe=Re[1],qe=[];function Ge(){fetch("".concat(x,"/api/getcompany")).then((function(e){return e.json()})).then((function(e){1===B.Users.role?qe=e.companies:3===B.Users.role?qe=e.companies.filter((function(e){return e.id===B.Users.company_id})):5!==B.Users.role&&6!==B.Users.role&&7!==B.Users.role||(qe=e.companies.filter((function(e){return e.id===B.Users.company_id}))),Fe(qe)})).catch((function(e){return console.log(e)}))}function Ke(){return(Ke=(0,r.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={company_name:t,address:Z,company_email:S,contact_no:E,city:U,country:I},e.next=3,fetch("".concat(x,"/api/addcompany"),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((function(e){e.ok?(ie(!0),Ge()):fe(!0)})).catch((function(e){console.error(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){return(Qe=(0,r.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x,"/api/delete-company"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n})}).then((function(e){e.ok?(xe(!0),Ge()):Ze(!0)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(){return(Ye=(0,r.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(x,"/api/update-company"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n,company_name:t,address:Z,company_email:S,contact_no:E,city:U,country:I})}).then((function(e){e.ok?(Se(!0),Ge()):Ee(!0)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,d.useEffect)((function(){Ge(),fetch("".concat(x,"/api/get_country")).then((function(e){return e.json()})).then((function(e){return Be(e.Country)})).catch((function(e){return console.log(e)}))}),[]),(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"row",children:[(0,y.jsx)("div",{className:"col-md 6",children:(0,y.jsx)("h3",{children:"Companies"})}),(0,y.jsx)("div",{className:"col-md 6",children:H?(0,y.jsx)(s.ZP,{className:"btn btn-primary",style:{float:"right",padding:"2px",width:"120px",backgroundColor:"white",fontWeight:"bold",color:"#0070ff"},onClick:function(){K(!0)},children:"Add Company"}):null})]}),(0,y.jsx)("br",{}),(0,y.jsxs)(a.Sx,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,style:{marginTop:"20px"},children:[(0,y.jsxs)(a.V,{color:"light",children:[(0,y.jsxs)(a.T6,{children:[(0,y.jsx)(a.is,{className:"text-center",style:R,children:"Sr/No"}),(0,y.jsx)(a.is,{className:"text-center",style:R,children:"Company Name"}),(0,y.jsx)(a.is,{className:"text-center",style:R,children:"Address"}),(0,y.jsx)(a.is,{className:"text-center",style:R,children:"Company Email"}),(0,y.jsx)(a.is,{className:"text-center",style:R,children:"Contact No"}),(0,y.jsx)(a.is,{className:"text-center",style:R,children:"City"}),(0,y.jsx)(a.is,{className:"text-center",style:R,children:"Country"}),J||M?(0,y.jsx)(a.is,{className:"text-center",style:R,children:"Action"}):null]}),Ve.map((function(e,n){return(0,y.jsxs)(a.T6,{children:[(0,y.jsx)(a.is,{className:"text-center",style:W,children:n+1}),(0,y.jsx)(a.is,{className:"text-center",style:W,children:e.company_name}),(0,y.jsx)(a.is,{className:"text-center",style:W,children:e.address}),(0,y.jsx)(a.is,{className:"text-center",style:W,children:e.company_email}),(0,y.jsx)(a.is,{className:"text-center",style:W,children:e.contact_no}),(0,y.jsx)(a.is,{className:"text-center",style:W,children:e.city}),(0,y.jsx)(a.is,{className:"text-center",style:W,children:e.country}),J||M?(0,y.jsxs)(a.is,{className:"text-center",style:W,children:[J?(0,y.jsx)(m.Z,{"aria-label":"update",onClick:function(){return ce(e.id)},children:(0,y.jsx)(h.Z,{htmlColor:"#28B463"})}):null,M?(0,y.jsx)(m.Z,{"aria-label":"delete",onClick:function(){return n=e.id,void ee(n);var n},children:(0,y.jsx)(f.Z,{htmlColor:"#FF0000"})}):null]}):null]},e.id)}))]}),(0,y.jsxs)(a.NR,{children:[(0,y.jsxs)(l.Z,{title:"Add a Company",open:G,onOk:function(){!function(){Ke.apply(this,arguments)}(),K(!1),j(""),g(""),_(""),w(""),V(""),z("")},okButtonProps:{style:{background:"blue"}},onCancel:function(){K(!1),j(""),g(""),_(""),w(""),V(""),z("")},maskClosable:!1,children:[(0,y.jsx)("br",{}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Company"}),(0,y.jsx)("input",{type:"text",value:t,onChange:function(e){return j(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Company Name"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Address"}),(0,y.jsx)("input",{type:"text",value:Z,onChange:function(e){return g(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Address"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Email"}),(0,y.jsx)("input",{type:"text",value:S,onChange:function(e){return _(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Email"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Contact"}),(0,y.jsx)("input",{type:"text",value:E,onChange:function(e){return w(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Contact No"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Country"}),(0,y.jsx)(i.Z.Item,{children:(0,y.jsx)(u.Z,{placeholder:"Select Country",showSearch:!0,onChange:we,value:I,children:ze.map((function(e){return(0,y.jsx)(u.Z.Option,{value:e.name,children:e.name},e.id)}))})})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"City"}),(0,y.jsx)(i.Z.Item,{children:(0,y.jsx)(u.Z,{placeholder:"Select City",showSearch:!0,onChange:Oe,value:U,children:Me.map((function(e){return(0,y.jsx)(u.Z.Option,{value:e.name,children:e.name},e.id)}))})})]})]}),(0,y.jsx)(l.Z,{title:"Are you sure you want to delete?",open:$,onOk:function(){!function(e){Qe.apply(this,arguments)}($),ee(!1)},okButtonProps:{style:{background:"blue"}},onCancel:function(){ee(!1)},style:{position:"fixed",top:"25%",left:"40%"}}),(0,y.jsxs)(l.Z,{title:"Update a Company",open:oe,onOk:function(){!function(e){Ye.apply(this,arguments)}(oe),re(!1)},onCancel:function(){re(!1)},okButtonProps:{style:{background:"blue"}},maskClosable:!1,children:[(0,y.jsx)("br",{}),We.map((function(e){return(0,y.jsxs)("div",{children:[(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Company"}),(0,y.jsx)("input",{type:"text",defaultValue:e.company_name,onChange:function(e){return j(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Company Name"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Address"}),(0,y.jsx)("input",{type:"text",defaultValue:e.address,onChange:function(e){return g(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Address"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Company"}),(0,y.jsx)("input",{type:"text",defaultValue:e.company_email,onChange:function(e){return _(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Email"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Contact"}),(0,y.jsx)("input",{type:"text",defaultValue:e.contact_no,onChange:function(e){return w(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Contact No"})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"Country"}),(0,y.jsx)(i.Z.Item,{children:(0,y.jsx)(u.Z,{placeholder:"Select Country",showSearch:!0,onChange:we,defaultValue:e.country,children:ze.map((function(e){return(0,y.jsx)(u.Z.Option,{value:e.name,children:e.name},e.id)}))})})]}),(0,y.jsxs)("div",{className:"form-outline mb-3",children:[(0,y.jsx)("label",{children:"City"}),(0,y.jsx)(i.Z.Item,{children:(0,y.jsx)(u.Z,{placeholder:"Select City",showSearch:!0,onChange:Oe,defaultValue:e.city,children:Me.map((function(e){return(0,y.jsx)(u.Z.Option,{value:e.name,children:e.name},e.id)}))})})]})]},e.id)}))]}),le&&(0,y.jsx)(p.Z,{onClose:function(){ie(!1)},severity:"success",style:L,children:"Company Added Successfully"}),me&&(0,y.jsx)(p.Z,{onClose:function(){fe(!1)},severity:"error",style:L,children:"Failed to Add Company"}),ye&&(0,y.jsx)(p.Z,{onClose:function(){xe(!1)},severity:"success",style:L,children:"Company Deleted Successfully"}),ve&&(0,y.jsx)(p.Z,{onClose:function(){Ze(!1)},severity:"error",style:L,children:"Failed to Delete Company"}),be&&(0,y.jsx)(p.Z,{onClose:function(){Se(!1)},severity:"success",style:L,children:"Company Updated Successfully"}),Te&&(0,y.jsx)(p.Z,{onClose:function(){Ee(!1)},severity:"error",style:L,children:"Failed to Update Company"})]})]})]})}},27247:function(e,n,t){var o=t(64836);n.Z=void 0;var r=o(t(45649)),c=t(80184),a=(0,r.default)((0,c.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");n.Z=a},41286:function(e,n,t){var o=t(64836);n.Z=void 0;var r=o(t(45649)),c=t(80184),a=(0,r.default)((0,c.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");n.Z=a}}]);
//# sourceMappingURL=7059.12522abf.chunk.js.map
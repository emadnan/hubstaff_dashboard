"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[8417],{38417:function(e,t,n){n.r(t);var r=n(74165),o=n(15861),s=n(29439),c=n(72791),a=n(78983),i=n(87309),l=n(42535),u=n(81640),d=n(15696),m=n(13400),f=n(27247),p=n(41286),h=n(19658),x=n(80184),y="http://10.3.3.80";t.default=function(){var e=(0,c.useState)(""),t=(0,s.Z)(e,2),n=t[0],j=t[1],v=(0,c.useState)(""),Z=(0,s.Z)(v,2),g=Z[0],b=Z[1],C=(0,c.useState)(""),N=(0,s.Z)(C,2),D=N[0],_=N[1],S=JSON.parse(localStorage.getItem("user-info")),k=S.permissions.map((function(e){return{name:e.name}})),T=k.some((function(e){return"Create_Department"===e.name})),w=k.some((function(e){return"Update_Department"===e.name})),U=k.some((function(e){return"Delete_Department"===e.name})),E={position:"fixed",top:"10%",left:"55%",transform:"translateX(-50%)"},O={color:"white",backgroundColor:"#0070FF ",padding:"15px",fontFamily:"Arial",textAlign:"center",alignSelf:"flex-end"},F={backgroundColor:"white "},A=(0,c.useState)(!1),P=(0,s.Z)(A,2),V=P[0],z=P[1],B=(0,c.useState)(!1),J=(0,s.Z)(B,2),M=J[0],I=J[1],H=(0,c.useState)(!1),L=(0,s.Z)(H,2),R=L[0],W=L[1],X=function(e){!function(e){fetch("".concat(y,"/api/getdepartment-by-id/").concat(e)).then((function(e){return e.json()})).then((function(e){we(e.Departments),b(e.Departments[0].department_name),_(e.Departments[0].description),j(e.Departments[0].company_id)})).catch((function(e){return console.log(e)}))}(e),W(e)},q=(0,c.useState)(!1),G=(0,s.Z)(q,2),K=G[0],Q=G[1];(0,c.useEffect)((function(){if(K){var e=setTimeout((function(){Q(!1)}),3e3);return function(){return clearTimeout(e)}}}),[K]);var Y=(0,c.useState)(!1),$=(0,s.Z)(Y,2),ee=$[0],te=$[1];(0,c.useEffect)((function(){if(ee){var e=setTimeout((function(){te(!1)}),3e3);return function(){return clearTimeout(e)}}}),[ee]);var ne=(0,c.useState)(!1),re=(0,s.Z)(ne,2),oe=re[0],se=re[1];(0,c.useEffect)((function(){if(oe){var e=setTimeout((function(){se(!1)}),3e3);return function(){return clearTimeout(e)}}}),[oe]);var ce=(0,c.useState)(!1),ae=(0,s.Z)(ce,2),ie=ae[0],le=ae[1];(0,c.useEffect)((function(){if(ie){var e=setTimeout((function(){le(!1)}),3e3);return function(){return clearTimeout(e)}}}),[ie]);var ue=(0,c.useState)(!1),de=(0,s.Z)(ue,2),me=de[0],fe=de[1];(0,c.useEffect)((function(){if(me){var e=setTimeout((function(){fe(!1)}),3e3);return function(){return clearTimeout(e)}}}),[me]);var pe=(0,c.useState)(!1),he=(0,s.Z)(pe,2),xe=he[0],ye=he[1];(0,c.useEffect)((function(){if(xe){var e=setTimeout((function(){ye(!1)}),3e3);return function(){return clearTimeout(e)}}}),[xe]);var je=function(e){j(e)},ve=(0,c.useState)([]),Ze=(0,s.Z)(ve,2),ge=Ze[0],be=Ze[1],Ce=(0,c.useState)([]),Ne=(0,s.Z)(Ce,2),De=Ne[0],_e=Ne[1],Se=(0,c.useState)([]),ke=(0,s.Z)(Se,2),Te=ke[0],we=ke[1],Ue=[];function Ee(){fetch("".concat(y,"/api/getdepartment")).then((function(e){return e.json()})).then((function(e){if(1===S.Users.role)Ue=e.Departments;else{if(3!==S.Users.role)return null;Ue=e.Departments.filter((function(e){return e.company_id===S.Users.company_id}))}be(Ue)})).catch((function(e){return console.log(e)}))}function Oe(){return(Oe=(0,o.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={company_id:n,department_name:g,description:D},console.log(t),e.next=4,fetch("".concat(y,"/api/add_department"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(e){e.ok?(Q(!0),Ee()):te(!0)})).catch((function(e){console.error(e)}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fe(){return(Fe=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/api/delete-department"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t})}).then((function(e){e.ok?(se(!0),Ee()):le(!0)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ae(){return(Ae=(0,o.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/api/update-department"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,company_id:n,department_name:g,description:D})}).then((function(e){e.ok?(fe(!0),Ee()):ye(!0)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,c.useEffect)((function(){Ee(),fetch("".concat(y,"/api/getcompany")).then((function(e){return e.json()})).then((function(e){1===S.Users.role?Ue=e.companies:3===S.Users.role?Ue=e.companies.filter((function(e){return e.id===S.Users.company_id})):5!==S.Users.role&&6!==S.Users.role&&7!==S.Users.role||(Ue=e.companies.filter((function(e){return e.id===S.Users.company_id}))),_e(Ue)})).catch((function(e){return console.log(e)}))}),[]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-md 6",children:(0,x.jsx)("h3",{children:"Departments"})}),(0,x.jsx)("div",{className:"col-md 6",children:T?(0,x.jsx)(i.ZP,{className:"btn btn-primary",style:{float:"right",padding:"2px",width:"150px",backgroundColor:"white",fontWeight:"bold",color:"#0070ff"},onClick:function(){console.log(k),z(!0)},children:"Add Department"}):null})]}),(0,x.jsx)("br",{}),(0,x.jsxs)(a.Sx,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,style:{marginTop:"20px"},children:[(0,x.jsxs)(a.V,{color:"light",children:[(0,x.jsxs)(a.T6,{children:[(0,x.jsx)(a.is,{className:"text-center",style:O,children:"Sr/No"}),(0,x.jsx)(a.is,{className:"text-center",style:O,children:"Company Name"}),(0,x.jsx)(a.is,{className:"text-center",style:O,children:"Department Name"}),(0,x.jsx)(a.is,{className:"text-center",style:O,children:"Description"}),w||U?(0,x.jsx)(a.is,{className:"text-center",style:O,children:"Action"}):null]}),ge.map((function(e,t){return(0,x.jsxs)(a.T6,{children:[(0,x.jsx)(a.is,{className:"text-center",style:F,children:t+1}),(0,x.jsx)(a.is,{className:"text-center",style:F,children:e.company_name}),(0,x.jsx)(a.is,{className:"text-center",style:F,children:e.department_name}),(0,x.jsx)(a.is,{className:"text-center",style:F,children:e.description}),w||U?(0,x.jsxs)(a.is,{className:"text-center",style:F,children:[w?(0,x.jsx)(m.Z,{"aria-label":"update",onClick:function(){return X(e.id)},children:(0,x.jsx)(p.Z,{htmlColor:"#28B463"})}):null,U?(0,x.jsx)(m.Z,{"aria-label":"delete",onClick:function(){return t=e.id,void I(t);var t},children:(0,x.jsx)(f.Z,{htmlColor:"#FF0000"})}):null]}):null]},e.id)}))]}),(0,x.jsxs)(a.NR,{children:[(0,x.jsxs)(l.Z,{title:"Add a Department",open:V,onOk:function(){!function(){Oe.apply(this,arguments)}(),z(!1),j(""),b(""),_("")},okButtonProps:{style:{background:"blue"}},onCancel:function(){z(!1),j(""),b(""),_("")},maskClosable:!1,children:[(0,x.jsx)("br",{}),(0,x.jsxs)("div",{className:"form-outline mb-3",children:[(0,x.jsx)("label",{children:"Company"}),(0,x.jsx)(u.Z.Item,{children:(0,x.jsx)(d.Z,{placeholder:"Select Company",onChange:je,value:n,children:De.map((function(e){return(0,x.jsx)(d.Z.Option,{value:e.name,children:e.company_name},e.id)}))})})]}),(0,x.jsxs)("div",{className:"form-outline mb-3",children:[(0,x.jsx)("label",{children:"Department"}),(0,x.jsx)("input",{type:"text",value:g,onChange:function(e){return b(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Department Name"})]}),(0,x.jsxs)("div",{className:"form-outline mb-3",children:[(0,x.jsx)("label",{children:"Description"}),(0,x.jsx)("input",{type:"text",value:D,onChange:function(e){return _(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Description"})]})]}),(0,x.jsxs)(l.Z,{title:"Update a Department",open:R,onOk:function(){!function(e){Ae.apply(this,arguments)}(R),W(!1),j(""),b(""),_("")},okButtonProps:{style:{background:"blue"}},onCancel:function(){W(!1),j(""),b(""),_("")},maskClosable:!1,children:[(0,x.jsx)("br",{}),Te.map((function(e){return(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"form-outline mb-3",children:[(0,x.jsx)("label",{children:"Company"}),(0,x.jsx)(u.Z.Item,{children:(0,x.jsx)(d.Z,{placeholder:"Select Company",onChange:je,defaultValue:e.company_name,children:De.map((function(e){return(0,x.jsx)(d.Z.Option,{value:e.name,children:e.company_name},e.id)}))})})]}),(0,x.jsxs)("div",{className:"form-outline mb-3",children:[(0,x.jsx)("label",{children:"Department"}),(0,x.jsx)("input",{type:"text",defaultValue:e.department_name,onChange:function(e){return b(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Department Name"})]}),(0,x.jsxs)("div",{className:"form-outline mb-3",children:[(0,x.jsx)("label",{children:"Description"}),(0,x.jsx)("input",{type:"text",defaultValue:e.description,onChange:function(e){return _(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Description"})]})]},e.id)}))]}),(0,x.jsx)(l.Z,{title:"Are you sure you want to delete?",open:M,onOk:function(){!function(e){Fe.apply(this,arguments)}(M),I(!1)},okButtonProps:{style:{background:"blue"}},onCancel:function(){I(!1)},style:{position:"fixed",top:"25%",left:"40%"}}),K&&(0,x.jsx)(h.Z,{onClose:function(){Q(!1)},severity:"success",style:E,children:"Department Added Successfully"}),ee&&(0,x.jsx)(h.Z,{onClose:function(){te(!1)},severity:"error",style:E,children:"Failed to Add Department"}),oe&&(0,x.jsx)(h.Z,{onClose:function(){se(!1)},severity:"success",style:E,children:"Department Deleted Successfully"}),ie&&(0,x.jsx)(h.Z,{onClose:function(){le(!1)},severity:"error",style:E,children:"Failed to Delete Department"}),me&&(0,x.jsx)(h.Z,{onClose:function(){fe(!1)},severity:"success",style:E,children:"Department Updated Successfully"}),xe&&(0,x.jsx)(h.Z,{onClose:function(){ye(!1)},severity:"error",style:E,children:"Failed to Update Department"})]})]})]})}},27247:function(e,t,n){var r=n(64836);t.Z=void 0;var o=r(n(45649)),s=n(80184),c=(0,o.default)((0,s.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=c},41286:function(e,t,n){var r=n(64836);t.Z=void 0;var o=r(n(45649)),s=n(80184),c=(0,o.default)((0,s.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");t.Z=c}}]);
//# sourceMappingURL=8417.f32a17ac.chunk.js.map
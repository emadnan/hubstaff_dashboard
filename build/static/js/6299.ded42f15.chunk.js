"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6299],{96299:function(e,n,t){t.r(n);var o=t(74165),s=t(15861),r=t(93433),c=t(29439),i=t(78983),l=t(72791),a=t(87309),u=t(42535),f=t(77128),d=t(70592),h=t(13400),m=t(27247),x=t(41286),p=t(19658),j=t(24684),v=t(80184),y="http://10.3.3.80";n.default=function(){var e=(0,l.useState)(""),n=(0,c.Z)(e,2),t=n[0],Z=n[1],g=JSON.parse(localStorage.getItem("user-info")),N=g.permissions.map((function(e){return{name:e.name}})),C=N.some((function(e){return"Create_Role"===e.name})),S=N.some((function(e){return"Update_Role"===e.name})),b=N.some((function(e){return"Delete_Role"===e.name})),k=N.some((function(e){return"Assign_Permission"===e.name})),T={position:"fixed",top:"10%",left:"55%",transform:"translateX(-50%)"},_={color:"white",backgroundColor:"#0070FF ",padding:"15px",fontFamily:"Arial",textAlign:"center",alignSelf:"flex-end"},w={backgroundColor:"white "},R=(0,l.useState)(!1),P=(0,c.Z)(R,2),A=P[0],E=P[1],O=(0,l.useState)(!1),F=(0,c.Z)(O,2),V=F[0],z=F[1],U=(0,l.useState)(!1),H=(0,c.Z)(U,2),B=H[0],D=H[1],J=function(e){!function(e){fetch("".concat(y,"/api/get_roles_by_id/").concat(e)).then((function(e){return e.json()})).then((function(e){De(e.roles),Z(e.roles[0].name)})).catch((function(e){return console.log(e)}))}(e),D(e)},M=(0,l.useState)(!1),L=(0,c.Z)(M,2),I=L[0],W=L[1],X=function(e){!function(e){fetch("".concat(y,"/api/get-permission-by-id/").concat(e)).then((function(e){return e.json()})).then((function(e){var n=e.Permission.map((function(e){return e.permission_id}));Ie(n),console.log(n)})).catch((function(e){return console.log(e)}))}(e),W(e)},q=(0,l.useState)(!1),G=(0,c.Z)(q,2),K=G[0],Q=G[1];(0,l.useEffect)((function(){if(K){var e=setTimeout((function(){Q(!1)}),3e3);return function(){return clearTimeout(e)}}}),[K]);var Y=(0,l.useState)(!1),$=(0,c.Z)(Y,2),ee=$[0],ne=$[1];(0,l.useEffect)((function(){if(ee){var e=setTimeout((function(){ne(!1)}),3e3);return function(){return clearTimeout(e)}}}),[ee]);var te=(0,l.useState)(!1),oe=(0,c.Z)(te,2),se=oe[0],re=oe[1];(0,l.useEffect)((function(){if(se){var e=setTimeout((function(){re(!1)}),3e3);return function(){return clearTimeout(e)}}}),[se]);var ce=(0,l.useState)(!1),ie=(0,c.Z)(ce,2),le=ie[0],ae=ie[1];(0,l.useEffect)((function(){if(le){var e=setTimeout((function(){ae(!1)}),3e3);return function(){return clearTimeout(e)}}}),[le]);var ue=(0,l.useState)(!1),fe=(0,c.Z)(ue,2),de=fe[0],he=fe[1];(0,l.useEffect)((function(){if(de){var e=setTimeout((function(){he(!1)}),3e3);return function(){return clearTimeout(e)}}}),[de]);var me=(0,l.useState)(!1),xe=(0,c.Z)(me,2),pe=xe[0],je=xe[1];(0,l.useEffect)((function(){if(pe){var e=setTimeout((function(){je(!1)}),3e3);return function(){return clearTimeout(e)}}}),[pe]);var ve=(0,l.useState)(!1),ye=(0,c.Z)(ve,2),Ze=ye[0],ge=ye[1];(0,l.useEffect)((function(){if(Ze){var e=setTimeout((function(){ge(!1)}),3e3);return function(){return clearTimeout(e)}}}),[Ze]);var Ne=(0,l.useState)(!1),Ce=(0,c.Z)(Ne,2),Se=Ce[0],be=Ce[1];(0,l.useEffect)((function(){if(Se){var e=setTimeout((function(){be(!1)}),3e3);return function(){return clearTimeout(e)}}}),[Se]);var ke=(0,l.useState)([]),Te=(0,c.Z)(ke,2),_e=Te[0],we=Te[1],Re=(0,l.useState)([]),Pe=(0,c.Z)(Re,2),Ae=Pe[0],Ee=Pe[1],Oe=(0,l.useState)([]),Fe=(0,c.Z)(Oe,2),Ve=Fe[0],ze=Fe[1],Ue=(0,l.useState)([]),He=(0,c.Z)(Ue,2),Be=He[0],De=He[1],Je=(0,l.useState)([]),Me=(0,c.Z)(Je,2),Le=Me[0],Ie=Me[1];function We(){fetch("".concat(y,"/api/getroles")).then((function(e){return e.json()})).then((function(e){return we(e.roles)})).catch((function(e){return console.log(e)}))}function Xe(){fetch("".concat(y,"/api/getpermissions")).then((function(e){return e.json()})).then((function(e){return Ee(e.permissions)})).catch((function(e){return console.log(e)}))}function qe(){return(qe=(0,s.Z)((0,o.Z)().mark((function e(){var n;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t},e.next=3,fetch("".concat(y,"/api/addrole"),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((function(e){e.ok?(Q(!0),We()):ne(!0)})).catch((function(e){console.error(e)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(){return(Ge=(0,s.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/api/delete-role"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n})}).then((function(e){e.ok?(re(!0),We()):ae(!0)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(){return(Ke=(0,s.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/api/update-role"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:n,name:t})}).then((function(e){e.ok?(he(!0),We()):je(!0)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(){return(Qe=(0,s.Z)((0,o.Z)().mark((function e(n){return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(y,"/api/role-permissions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role_id:n,permissions:Ve})}).then((function(e){e.ok?(ge(!0),Xe()):be(!0)})).catch((function(e){console.error(e)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,l.useEffect)((function(){We(),Xe()}),[]),(0,l.useEffect)((function(){ze(Le)}),[Le]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col-md 6",children:(0,v.jsx)("h3",{children:"Roles"})}),(0,v.jsx)("div",{className:"col-md 6",children:C?(0,v.jsx)(a.ZP,{className:"btn btn-primary",style:{float:"right",padding:"2px",width:"120px",backgroundColor:"white",fontWeight:"bold",color:"#0070ff"},onClick:function(){E(!0)},children:"Add Role"}):null})]}),(0,v.jsx)("br",{}),(0,v.jsxs)(i.Sx,{align:"middle",className:"mb-0 border",hover:!0,responsive:!0,style:{marginTop:"20px"},children:[(0,v.jsxs)(i.V,{color:"light",children:[(0,v.jsxs)(i.T6,{children:[(0,v.jsx)(i.is,{className:"text-center",style:_,children:"Sr/No"}),(0,v.jsx)(i.is,{className:"text-center",style:_,children:"Role Name"}),S||b?(0,v.jsx)(i.is,{className:"text-center",style:_,children:"Actions"}):null,k?(0,v.jsx)(i.is,{className:"text-center",style:_,children:"Assign"}):null]}),1===g.Users.role||3===g.Users.role?_e.map((function(e,n){return(0,v.jsxs)(i.T6,{children:[(0,v.jsx)(i.is,{className:"text-center",style:w,children:n+1}),(0,v.jsx)(i.is,{className:"text-center",style:w,children:e.name}),S||b?(0,v.jsxs)(i.is,{className:"text-center",style:w,children:[S?(0,v.jsx)(h.Z,{"aria-label":"update",title:"Update",onClick:function(){return J(e.id)},children:(0,v.jsx)(x.Z,{htmlColor:"#28B463"})}):null,b?(0,v.jsx)(h.Z,{"aria-label":"delete",title:"Delete",onClick:function(){return n=e.id,void z(n);var n},children:(0,v.jsx)(m.Z,{htmlColor:"#FF0000"})}):null]}):null,k?(0,v.jsx)(i.is,{className:"text-center",style:w,children:(0,v.jsx)(h.Z,{"aria-label":"assign",title:"Assign Permission",onClick:function(){return X(e.id)},children:(0,v.jsx)(j.Z,{htmlColor:"#0070ff"})})}):null]},e.id)})):null]}),(0,v.jsx)(i.NR,{})]}),(0,v.jsxs)(u.Z,{title:"Add a Role",open:A,onOk:function(){!function(){qe.apply(this,arguments)}(),E(!1),Z("")},okButtonProps:{style:{background:"blue"}},onCancel:function(){E(!1),Z("")},maskClosable:!1,children:[(0,v.jsx)("br",{}),(0,v.jsxs)("div",{className:"form-outline mb-3",children:[(0,v.jsx)("label",{children:"Role"}),(0,v.jsx)("input",{type:"text",value:t,onChange:function(e){return Z(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Role Name"})]})]}),(0,v.jsxs)(u.Z,{title:"Update a Role",open:B,onOk:function(){!function(e){Ke.apply(this,arguments)}(B),D(!1)},okButtonProps:{style:{background:"blue"}},onCancel:function(){D(!1)},maskClosable:!1,children:[(0,v.jsx)("br",{}),Be.map((function(e){return(0,v.jsx)("div",{children:(0,v.jsx)("div",{className:"form-outline mb-3",children:(0,v.jsx)("input",{type:"text",defaultValue:e.name,onChange:function(e){return Z(e.target.value)},className:"form-control form-control-lg",placeholder:"Enter Role Name"})})},e.id)}))]}),(0,v.jsx)(u.Z,{title:"Are you sure you want to delete?",open:V,onOk:function(){!function(e){Ge.apply(this,arguments)}(V),z(!1)},okButtonProps:{style:{background:"blue"}},onCancel:function(){z(!1)},style:{position:"fixed",top:"25%",left:"40%"}}),(0,v.jsxs)(u.Z,{title:"Assign Permissions",open:I,onOk:function(){!function(e){Qe.apply(this,arguments)}(I),W(!1)},okButtonProps:{style:{background:"blue"}},onCancel:function(){W(!1)},children:[(0,v.jsx)("br",{}),(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col md-2 text-center",children:(0,v.jsx)("h6",{children:"Sr/No"})}),(0,v.jsx)("div",{className:"col md-3"}),(0,v.jsx)("div",{className:"col md-2 text-center",children:(0,v.jsx)("h6",{children:"Permissions"})}),(0,v.jsx)("div",{className:"col md-3"}),(0,v.jsx)("div",{className:"col md-2 text-center",children:(0,v.jsx)("h6",{style:{display:"flex",justifyContent:"flex-end",float:"right"},children:"Select"})}),"\xa0",(0,v.jsx)(f.Z,{})]}),(0,v.jsx)("div",{children:Ae.map((function(e,n){return(0,v.jsxs)("div",{className:"row",children:[(0,v.jsx)("div",{className:"col md-2 text-center",children:(0,v.jsx)("h6",{children:n+1})}),(0,v.jsx)("div",{className:"col md-3"}),(0,v.jsx)("div",{className:"col md-2 text-center",children:(0,v.jsx)("h6",{children:e.name})}),(0,v.jsx)("div",{className:"col md-3"}),(0,v.jsx)("div",{className:"col md-2 text-center",children:(0,v.jsx)(d.Z,{checked:Ve.includes(e.id),onChange:function(n){return function(e,n){e.target.checked?ze([].concat((0,r.Z)(Ve),[n])):ze(Ve.filter((function(e){return e!==n})))}(n,e.id)}})}),"\xa0",(0,v.jsx)(f.Z,{})]},e.id)}))})]}),K&&(0,v.jsx)(p.Z,{onClose:function(){Q(!1)},severity:"success",style:T,children:"Role Added Successfully"}),ee&&(0,v.jsx)(p.Z,{onClose:function(){ne(!1)},severity:"error",style:T,children:"Failed to Add Role"}),se&&(0,v.jsx)(p.Z,{onClose:function(){re(!1)},severity:"success",style:T,children:"Role Deleted Successfully"}),le&&(0,v.jsx)(p.Z,{onClose:function(){ae(!1)},severity:"error",style:T,children:"Failed to Delete Role"}),de&&(0,v.jsx)(p.Z,{onClose:function(){he(!1)},severity:"success",style:T,children:"Role Updated Successfully"}),pe&&(0,v.jsx)(p.Z,{onClose:function(){je(!1)},severity:"error",style:T,children:"Failed to Update Role"}),Ze&&(0,v.jsx)(p.Z,{onClose:function(){ge(!1)},severity:"success",style:T,children:"Permissions Assigned Successfully"}),Se&&(0,v.jsx)(p.Z,{onClose:function(){be(!1)},severity:"error",style:T,children:"Failed to Assign Permissions"})]})}},27247:function(e,n,t){var o=t(64836);n.Z=void 0;var s=o(t(45649)),r=t(80184),c=(0,s.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");n.Z=c},41286:function(e,n,t){var o=t(64836);n.Z=void 0;var s=o(t(45649)),r=t(80184),c=(0,s.default)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");n.Z=c},24684:function(e,n,t){var o=t(64836);n.Z=void 0;var s=o(t(45649)),r=t(80184),c=(0,s.default)((0,r.jsx)("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm6 12H6v-1c0-2 4-3.1 6-3.1s6 1.1 6 3.1v1z"}),"PermContactCalendar");n.Z=c}}]);
//# sourceMappingURL=6299.ded42f15.chunk.js.map